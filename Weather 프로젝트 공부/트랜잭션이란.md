# 트랜잭션
- 데이터베이스의 상태를 변화시키기 위해 수행하는 작업 단위를 의미한다.
- 트랜잭션을 활용하면 DB의 상태를 변화시키던 도중 오류가 발생하면 작업을 시작하기 전으로 되돌릴 수 있다.
- 트랜잭션을 정의하는 4 가지 속성이 있다.

---

## ACID 속성
### 원자성 (Atomicity)
특정 트랜잭션에 속한 여러개의 실행문을 하나의 단위로 취급한다. 이렇게 하면 결과는 성공이거나 실패하는 것 뿐이며 하나의 실행문이 실패하면 다른 실행문들이 성공했어도 실패로 간주되어 초기 상태로 되돌려서 안전을 보장한다.

### 일관성 (Consistency)
트랜잭션이 DB의 상태를 변경할 때 DB의 일관성을 유지해야한다. DB의 고유한 데이터 규칙을 무시하고 수정하거나 삭제하면 일관성이 깨진다.

### 독립성 (Isolation)
모든 트랜잭션은 다른 트랜잭션으로부터 독립적이다. 한 트랜잭션이 다른 트랜잭션에 의해 참조되거나 수정될 수 없으며 동시에 실행되어도 DB의 일관성이 유지되어야 한다. 동시에 트랜잭션을 수행해도 순차적으로 각 트랜잭션을 수행한 것과 같다.

### 지속성 (Durability)
한 트랜잭션의 성공, 실패에 관계없이 작업이 종료되면 이 트랜잭션에 대한 기록이 남아야한다.

---

## 트랜잭션 연산
### 커밋 (Commit)
트랜잭션의 전체 연산이 성공적으로 끝나면 트랜잭션은 마지막으로 커밋을 수행한다.

### 롤백 (Rollback)
트랜잭션의 과정 중 오류가 발생하면 마지막으로 롤백을 수행한다.

---

## 트랜잭션 경쟁
### 트랜잭션 A 와 트랜잭션 B 가 같은 ROW를 대상으로 작업 수행하려 할 때 발생할 수 있는 문제들
#### Dirty Read
트랜잭션 A가 수정을 진행중일 때 트랜잭션 B가 값을 조회했다가 트랜잭션 A가 Rollback 하면 트랜잭션 B는 잘못된 값을 조회한 것이다.
    
#### Non Repeatable Read
트랜잭션 A가 조회를 두 번 수행할 때 그 사이에 트랜잭션 B가 값을 수정 후 커밋을 하게 되면 트랜잭션 A의 기대값이 중간에 바뀌게 된다.

#### Phantom Read
트랜잭션 A가 특정 범위 조회를 두 번 수행할 때 그 사이에 트랜잭션 B가 값을 수정 후 커밋을 하게 되면 트랜잭션 A의 범위 기대값이 중간에 바뀌게 된다.

---